<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administraci√≥n VIP Bot</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.min.js"></script>
    <style>
        :root {
            --primary-color: #4361ee;
            --primary-color-dark: #3a56d4;
            --primary-light: rgba(67, 97, 238, 0.15);
            --secondary-color: #7209b7;
            --bg-color: #f8f9fa;
            --text-color: #333;
            --card-bg: #ffffff;
            --border-color: #e6e6e6;
            --hover-color: #f0f2f5;
            --header-color: #f1f3f9;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 8px 24px rgba(0, 0, 0, 0.12);
            --transition: all 0.3s ease;
            --status-active: #0ca678;
            --status-active-bg: #e3fcef;
            --status-cancelled: #e03131;
            --status-cancelled-bg: #ffe3e3;
            --status-suspended: #f08c00;
            --status-suspended-bg: #fff3bf;
            --card-radius: 16px;
            --button-radius: 8px;
        }

        [data-theme="dark"] {
            --primary-color: #4cc9f0;
            --primary-color-dark: #3db8df;
            --primary-light: rgba(76, 201, 240, 0.15);
            --secondary-color: #f72585;
            --bg-color: #121212;
            --text-color: #e6e6e6;
            --card-bg: #1e1e1e;
            --border-color: #2d2d2d;
            --hover-color: #2a2a2a;
            --header-color: #252525;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            --shadow-hover: 0 8px 24px rgba(0, 0, 0, 0.3);
            --status-active-bg: rgba(12, 166, 120, 0.2);
            --status-cancelled-bg: rgba(224, 49, 49, 0.2);
            --status-suspended-bg: rgba(240, 140, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: var(--transition);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1300px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background-color: var(--card-bg);
            border-radius: var(--card-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .admin-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            box-shadow: var(--shadow);
            border: 3px solid var(--primary-color);
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.5rem;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .admin-avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(var(--primary-color-rgb), 0.5);
        }
        
        .avatar-text {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }

        .admin-name {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .admin-id {
            font-size: 0.85rem;
            color: #888;
        }

        .theme-toggle {
            background-color: var(--hover-color);
            border: none;
            border-radius: 30px;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-color);
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .theme-toggle i {
            font-size: 1.2rem;
        }

        h1, h2, h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-weight: 700;
        }

        h1 {
            font-size: 2rem;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h1 i, h2 i, h3 i {
            opacity: 0.8;
        }

        .panel-card {
            background-color: var(--card-bg);
            border-radius: var(--card-radius);
            box-shadow: var(--shadow);
            padding: 25px;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .panel-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: var(--card-bg);
            border-radius: var(--card-radius);
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary-color);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent 0%, rgba(255, 255, 255, 0.05) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-card:hover {
            transform: translateY(-7px);
            box-shadow: var(--shadow-hover);
        }

        .stat-card:nth-child(2) {
            border-left-color: var(--secondary-color);
        }

        .stat-card:nth-child(3) {
            border-left-color: var(--status-active);
        }

        .stat-card:nth-child(4) {
            border-left-color: var(--status-suspended);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            margin: 10px 0;
            color: var(--primary-color);
            position: relative;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .stat-card:nth-child(2) .stat-value {
            color: var(--secondary-color);
        }

        .stat-card:nth-child(3) .stat-value {
            color: var(--status-active);
        }

        .stat-card:nth-child(4) .stat-value {
            color: var(--status-suspended);
        }

        .stat-label {
            font-size: 1rem;
            color: #888;
            font-weight: 500;
            margin-top: 5px;
        }

        .stat-icon {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            background-color: var(--primary-light);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .stat-card:nth-child(2) .stat-icon {
            color: var(--secondary-color);
            background-color: rgba(114, 9, 183, 0.15);
        }

        .stat-card:nth-child(3) .stat-icon {
            color: var(--status-active);
            background-color: var(--status-active-bg);
        }

        .stat-card:nth-child(4) .stat-icon {
            color: var(--status-suspended);
            background-color: var(--status-suspended-bg);
        }

        .chart-container {
            width: 100%;
            height: 300px;
            margin: 30px 0;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .table-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .table-search {
            display: flex;
            align-items: center;
            border-radius: 30px;
            padding: 0 15px;
            background: var(--hover-color);
            border: 1px solid var(--border-color);
            max-width: 300px;
        }

        .table-search input {
            border: none;
            background: transparent;
            padding: 10px;
            font-size: 0.9rem;
            color: var(--text-color);
            width: 100%;
        }

        .table-search input:focus {
            outline: none;
        }

        .table-search i {
            color: #888;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 0;
            border-radius: 8px;
            overflow: hidden;
            background-color: var(--card-bg);
        }

        th, td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background-color: var(--header-color);
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tbody tr {
            transition: background-color 0.2s ease;
        }

        tbody tr:hover td {
            background-color: var(--hover-color);
        }

        .badge {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            gap: 5px;
        }

        .badge i {
            font-size: 0.7rem;
        }

        .badge-active {
            background-color: var(--status-active-bg);
            color: var(--status-active);
        }
        .badge-cancelled {
            background-color: var(--status-cancelled-bg);
            color: var(--status-cancelled);
        }
        .badge-expired {
            background-color: var(--status-suspended-bg);
            color: var(--status-suspended);
        }
        .badge-renewed {
            background-color: rgba(75, 192, 192, 0.2);
            color: #4bc0c0;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-top: 20px;
        }

        .pagination-item {
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            background-color: var(--hover-color);
            color: var(--text-color);
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .pagination-item:hover, .pagination-item.active {
            background-color: var(--primary-color);
            color: white;
        }

        .sql-container {
            margin-top: 30px;
        }

        .sql-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .sql-tools {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .sql-tools button {
            background-color: var(--hover-color);
            border: none;
            border-radius: var(--button-radius);
            padding: 8px 12px;
            font-size: 0.9rem;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .sql-tools button:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .sql-input {
            width: 100%;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: var(--button-radius);
            font-family: 'Consolas', 'Monaco', monospace;
            min-height: 150px;
            background-color: var(--bg-color);
            color: var(--text-color);
            resize: vertical;
            transition: border 0.3s ease;
            line-height: 1.5;
            font-size: 14px;
        }

        .sql-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--button-radius);
            cursor: pointer;
            font-weight: 600;
            text-align: center;
            text-decoration: none;
            transition: all 0.3s ease;
            gap: 8px;
        }

        .btn:hover {
            background-color: var(--primary-color-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background-color: var(--hover-color);
            color: var(--text-color);
        }

        .btn-secondary:hover {
            background-color: var(--border-color);
        }

        .actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn i {
            font-size: 1.1rem;
        }

        .info-message {
            padding: 15px;
            border-radius: var(--button-radius);
            margin: 20px 0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            animation: fadeIn 0.5s ease;
        }

        .error-message {
            background-color: var(--status-cancelled-bg);
            color: var(--status-cancelled);
        }

        .success-message {
            background-color: var(--status-active-bg);
            color: var(--status-active);
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: var(--card-bg);
            border-radius: var(--card-radius);
            padding: 25px;
            max-width: 80%;
            max-height: 80%;
            overflow: auto;
            box-shadow: var(--shadow);
            position: relative;
            animation: modalSlideIn 0.3s ease;
            border: 1px solid var(--border-color);
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            cursor: pointer;
            font-size: 1.2rem;
            color: var(--text-color);
            transition: color 0.2s ease;
        }

        .modal-close:hover {
            color: var(--primary-color);
        }

        .loading {
            display: none;
            justify-content: center;
            margin: 20px 0;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(var(--primary-color-rgb), 0.1);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            background-color: var(--card-bg);
            color: var(--text-color);
            text-align: center;
            border-radius: 6px;
            padding: 8px 12px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: var(--shadow);
            font-size: 0.8rem;
            white-space: nowrap;
            border: 1px solid var(--border-color);
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--card-bg) transparent transparent transparent;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .two-column {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
                padding: 15px;
            }
            
            .admin-info {
                flex-direction: column;
            }
            
            .actions {
                justify-content: center;
            }
            
            .panel-card {
                padding: 15px;
            }
            
            .stat-card {
                min-width: 100%;
            }
            
            .btn {
                width: 100%;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .chart-container {
                height: 250px;
            }
            
            .table-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .table-search {
                max-width: 100%;
            }
        }
        
        /* Estilos para tablas responsivas */
        @media (max-width: 600px) {
            table, thead, tbody, th, td, tr {
                display: block;
            }
            
            thead tr {
                position: absolute;
                top: -9999px;
                left: -9999px;
            }
            
            tr {
                margin-bottom: 15px;
                border: 1px solid var(--border-color);
                border-radius: 8px;
                overflow: hidden;
            }
            
            td {
                border: none;
                border-bottom: 1px solid var(--border-color);
                position: relative;
                padding-left: 50%;
                text-align: right;
            }
            
            td:last-child {
                border-bottom: none;
            }
            
            td:before {
                position: absolute;
                top: 50%;
                left: 10px;
                transform: translateY(-50%);
                width: 45%;
                padding-right: 10px;
                white-space: nowrap;
                font-weight: 600;
                text-align: left;
            }
            
            /* Etiquetas para cada columna */
            td:nth-of-type(1):before { content: "ID"; }
            td:nth-of-type(2):before { content: "Usuario"; }
            td:nth-of-type(3):before { content: "Plan"; }
            td:nth-of-type(4):before { content: "Precio"; }
            td:nth-of-type(5):before { content: "Inicio"; }
            td:nth-of-type(6):before { content: "Fin"; }
            td:nth-of-type(7):before { content: "Estado"; }
            
            /* Ajustes para la tabla de usuarios */
            table.users-table td:nth-of-type(3):before { content: "Nombre"; }
            table.users-table td:nth-of-type(4):before { content: "Registro"; }
        }
        
        /* Bot√≥n flotante de ayuda */
        .help-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .help-btn:hover {
            transform: translateY(-5px) rotate(15deg);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        /* Notificaci√≥n flotante */
        .notification {
            position: fixed;
            bottom: 30px;
            left: 30px;
            padding: 15px 20px;
            background-color: var(--card-bg);
            color: var(--text-color);
            border-radius: 8px;
            box-shadow: var(--shadow);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 100;
            max-width: 300px;
            border-left: 4px solid var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .notification i {
            font-size: 1.2rem;
            color: var(--primary-color);
        }
        
        .notification.error {
            border-left-color: var(--status-cancelled);
        }
        
        .notification.error i {
            color: var(--status-cancelled);
        }
        
        .notification.success {
            border-left-color: var(--status-active);
        }
        
        .notification.success i {
            color: var(--status-active);
        }
        
        :root {
            --primary-color-rgb: 67, 97, 238;
        }
        
        [data-theme="dark"] {
            --primary-color-rgb: 76, 201, 240;
        }
        
        /* Estilos para tooltips en consultas SQL */
        .sql-helper {
            position: absolute;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 10px;
            box-shadow: var(--shadow);
            z-index: 100;
            max-width: 300px;
            display: none;
        }
        
        .sql-helper.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        .sql-preview {
            margin-top: 15px;
            padding: 15px;
            background-color: var(--bg-color);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header animate__animated animate__fadeIn">
            <div class="admin-info">
                <div class="admin-avatar" id="admin-avatar">
                    <span class="avatar-text">A</span>
                </div>
                <div>
                    <div class="admin-name" id="admin-name">Admin 7212354235</div>
                    <div class="admin-id" id="admin-id">ID: 7212354235</div>
                </div>
            </div>
            <button class="theme-toggle" id="theme-toggle">
                <i class="fas fa-moon"></i>
                <span>Modo D√≠a</span>
            </button>
        </div>
        
        <div class="panel-card animate__animated animate__fadeInUp">
            <h1><i class="fas fa-tachometer-alt"></i> Panel de Administraci√≥n VIP Bot</h1>
            
            <h2><i class="fas fa-chart-line"></i> Estad√≠sticas Generales</h2>
            <div class="stats-container">
                <div class="stat-card animate__animated animate__fadeInUp" style="animation-delay: 0.1s;">
                    <i class="fas fa-users stat-icon"></i>
                    <div class="stat-value">1,248</div>
                    <div class="stat-label">Usuarios Totales</div>
                </div>
                <div class="stat-card animate__animated animate__fadeInUp" style="animation-delay: 0.2s;">
                    <i class="fas fa-credit-card stat-icon"></i>
                    <div class="stat-value">836</div>
                    <div class="stat-label">Suscripciones Totales</div>
                </div>
                <div class="stat-card animate__animated animate__fadeInUp" style="animation-delay: 0.3s;">
                    <i class="fas fa-check-circle stat-icon"></i>
                    <div class="stat-value">624</div>
                    <div class="stat-label">Suscripciones Activas</div>
                </div>
                <div class="stat-card animate__animated animate__fadeInUp" style="animation-delay: 0.4s;">
                    <i class="fas fa-link stat-icon"></i>
                    <div class="stat-value">159</div>
                    <div class="stat-label">Enlaces de Invitaci√≥n</div>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="growth-chart"></canvas>
            </div>
        </div>
        
        <div class="two-column">
            <div class="panel-card animate__animated animate__fadeInLeft">
                <h2><i class="fas fa-history"></i> Suscripciones Recientes</h2>
                <div class="table-controls">
                    <div class="table-search">
                        <i class="fas fa-search"></i>
                        <input type="text" id="subscription-search" placeholder="Buscar suscripci√≥n...">
                    </div>
                    <div class="table-actions">
                        <button class="btn btn-secondary" onclick="refreshTable('subscriptions')">
                            <i class="fas fa-sync-alt"></i> Actualizar
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="subscriptions-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Usuario</th>
                                <th>Plan</th>
                                <th>Precio</th>
                                <th>Inicio</th>
                                <th>Fin</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1354</td>
                                <td>
                                    user123
                                    <small>(ID: 78952)</small>
                                </td>
                                <td>Premium</td>
                                <td>$49.99</td>
                                <td>15/05/2025</td>
                                <td>15/06/2025</td>
                                <td>
                                    <span class="badge badge-active"><i class="fas fa-check-circle"></i> Activo</span>
                                </td>
                            </tr>
                            <tr>
                                <td>1353</td>
                                <td>
                                    miguel_angel
                                    <small>(ID: 45671)</small>
                                </td>
                                <td>B√°sico</td>
                                <td>$19.99</td>
                                <td>12/05/2025</td>
                                <td>12/06/2025</td>
                                <td>
                                    <span class="badge badge-active"><i class="fas fa-check-circle"></i> Activo</span>
                                </td>
                            </tr>
                            <tr>
                                <td>1352</td>
                                <td>
                                    laura84
                                    <small>(ID: 32147)</small>
                                </td>
                                <td>Premium</td>
                                <td>$49.99</td>
                                <td>10/04/2025</td>
                                <td>10/05/2025</td>
                                <td>
                                    <span class="badge badge-expired"><i class="fas fa-clock"></i> Expirado</span>
                                </td>
                            </tr>
                            <tr>
                                <td>1351</td>
                                <td>
                                    carlos_vt
                                    <small>(ID: 98745)</small>
                                </td>
                                <td>Premium+</td>
                                <td>$79.99</td>
                                <td>05/05/2025</td>
                                <td>05/06/2025</td>
                                <td>
                                    <span class="badge badge-active"><i class="fas fa-sync"></i> Renovado</span>
                                </td>
                            </tr>
                            <tr>
                                <td>1350</td>
                                <td>
                                    ana_maria22
                                    <small>(ID: 56234)</small>
                                </td>
                                <td>B√°sico</td>
                                <td>$19.99</td>
                                <td>01/05/2025</td>
                                <td>01/06/2025</td>
                                <td>
                                    <span class="badge badge-cancelled"><i class="fas fa-times-circle"></i> Cancelado</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="pagination" id="subscriptions-pagination">
                    <div class="pagination-item active">1</div>
                    <div class="pagination-item">2</div>
                    <div class="pagination-item">3</div>
                    <div class="pagination-item"><i class="fas fa-ellipsis-h"></i></div>
                    <div class="pagination-item">10</div>
                </div>
            </div>
            
            <div class="panel-card animate__animated animate__fadeInRight">
                <h2><i class="fas fa-user-plus"></i> Usuarios Recientes</h2>
                <div class="table-controls">
                    <div class="table-search">
                        <i class="fas fa-search"></i>
                        <input type="text" id="user-search" placeholder="Buscar usuario...">
                    </div>
                    <div class="table-actions">
                        <button class="btn btn-secondary" onclick="refreshTable('users')">
                            <i class="fas fa-sync-alt"></i> Actualizar
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="users-table" class="users-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Usuario</th>
                                <th>Nombre</th>
                                <th>Registro</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>78952</td>
                                <td>user123</td>
                                <td>Juan P√©rez</td>
                                <td>15/05/2025</td>
                            </tr>
                            <tr>
                                <td>78951</td>
                                <td>maria_85</td>
                                <td>Mar√≠a L√≥pez</td>
                                <td>14/05/2025</td>
                            </tr>
                            <tr>
                                <td>78950</td>
                                <td>andres_dev</td>
                                <td>Andr√©s Gonz√°lez</td>
                                <td>14/05/2025</td>
                            </tr>
                            <tr>
                                <td>78949</td>
                                <td>lucia_22</td>
                                <td>Luc√≠a Mart√≠nez</td>
                                <td>13/05/2025</td>
                            </tr>
                            <tr>
                                <td>78948</td>
                                <td>roberto_j</td>
                                <td>Roberto Jim√©nez</td>
                                <td>13/05/2025</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="pagination" id="users-pagination">
                    <div class="pagination-item active">1</div>
                    <div class="pagination-item">2</div>
                    <div class="pagination-item">3</div>
                    <div class="pagination-item"><i class="fas fa-ellipsis-h"></i></div>
                    <div class="pagination-item">15</div>
                </div>
            </div>
        </div>
        
        <div class="panel-card animate__animated animate__fadeInUp">
            <h2><i class="fas fa-database"></i> Consulta SQL</h2>
            <p>Ejecuta consultas personalizadas en la base de datos:</p>
            
            <div class="sql-tools">
                <button onclick="insertSQLTemplate('SELECT * FROM users LIMIT 10')">Consultar Usuarios</button>
                <button onclick="insertSQLTemplate('SELECT * FROM subscriptions WHERE status = \'ACTIVE\' LIMIT 10')">Suscripciones Activas</button>
                <button onclick="insertSQLTemplate('SELECT * FROM subscription_renewals ORDER BY renewal_date DESC LIMIT 10')">√öltimas Renovaciones</button>
                <button onclick="insertSQLTemplate('SELECT COUNT(*) AS total FROM users')">Contar Usuarios</button>
                <div class="tooltip">
                    <button onclick="toggleSQLHelper()"><i class="fas fa-lightbulb"></i> Ayuda</button>
                    <span class="tooltip-text">Muestra ayuda sobre consultas SQL</span>
                </div>
            </div>
            
            <form class="sql-form" method="post" id="sql-form">
                <textarea name="query" class="sql-input" id="sql-input" placeholder="SELECT * FROM users LIMIT 10;"></textarea>
                <div class="sql-preview" id="sql-preview"></div>
                <button type="submit" class="btn" id="execute-btn">
                    <i class="fas fa-play"></i> Ejecutar Consulta
                </button>
            </form>
            
            <div class="loading" id="loading">
                <div class="loading-spinner"></div>
            </div>
            
            <div id="sql-results" style="display: none;">
                <h3><i class="fas fa-table"></i> Resultados (<span id="result-count">0</span> filas)</h3>
                <div class="table-container">
                    <table id="results-table">
                        <thead id="results-header">
                            <tr>
                                <th>ID</th>
                            </tr>
                        </thead>
                        <tbody id="results-body">
                            <tr>
                                <td>Cargando...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="error-message" class="info-message error-message" style="display: none;">
                <i class="fas fa-exclamation-triangle"></i>
                <div>
                    <strong>Error:</strong>
                    <span id="error-content"></span>
                </div>
            </div>
            
            <div id="success-message" class="info-message success-message" style="display: none;">
                <i class="fas fa-check-circle"></i>
                <div>
                    <strong>√âxito:</strong>
                    <span id="success-content"></span>
                </div>
            </div>
        </div>
        
        <div class="panel-card animate__animated animate__fadeInUp">
            <h2><i class="fas fa-tools"></i> Herramientas de Administraci√≥n</h2>
            <p>Acciones disponibles para administrar el bot</p>
            
            <div class="actions">
                <a href="javascript:void(0)" class="btn btn-secondary" id="check-subscriptions-btn" onclick="checkSubscriptions()">
                    <i class="fas fa-user-check"></i> Verificar Estado de Suscripciones
                </a>
                <a href="/admin/download-database?admin_id={{ admin_id }}" class="btn" id="download-btn">
                    <i class="fas fa-download"></i> Descargar Base de Datos
                </a>
                <a href="javascript:void(0)" class="btn btn-secondary" onclick="sendBotCommand('/stats')">
                    <i class="fas fa-chart-bar"></i> Ver Estad√≠sticas en Bot
                </a>
                <a href="javascript:void(0)" class="btn btn-secondary" onclick="sendBotCommand('/test_invite')">
                    <i class="fas fa-link"></i> Probar Generaci√≥n de Enlace
                </a>
                <a href="javascript:void(0)" class="btn btn-secondary" onclick="sendBotCommand('/check_permissions')">
                    <i class="fas fa-shield-alt"></i> Verificar Permisos del Bot
                </a>
                <a href="/" class="btn btn-secondary">
                    <i class="fas fa-home"></i> Volver al Inicio
                </a>
            </div>
        </div>
    </div>
    
    <!-- Modal para verificaci√≥n de suscripciones -->
    <div class="modal" id="subscription-check-modal">
        <div class="modal-content">
            <div class="modal-close" onclick="closeModal('subscription-check-modal')">
                <i class="fas fa-times"></i>
            </div>
            <h3><i class="fas fa-user-check"></i> Verificaci√≥n de Suscripciones</h3>
            <div id="subscription-check-content">
                <div style="display: flex; justify-content: center; padding: 40px;">
                    <div class="loading-spinner"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para ayuda SQL -->
    <div class="modal" id="sql-help-modal">
        <div class="modal-content">
            <div class="modal-close" onclick="closeModal('sql-help-modal')">
                <i class="fas fa-times"></i>
            </div>
            <h3><i class="fas fa-lightbulb"></i> Ayuda de Consultas SQL</h3>
            <div style="margin-top: 20px;">
                <h4>Tablas Disponibles:</h4>
                <ul style="margin-left: 20px; line-height: 1.8;">
                    <li><strong>users</strong> - Informaci√≥n de usuarios</li>
                    <li><strong>subscriptions</strong> - Suscripciones de los usuarios</li>
                    <li><strong>subscription_renewals</strong> - Historial de renovaciones</li>
                    <li><strong>invite_links</strong> - Enlaces de invitaci√≥n generados</li>
                </ul>
                
                <h4 style="margin-top: 20px;">Ejemplos de Consultas:</h4>
                <div style="background-color: var(--bg-color); padding: 15px; border-radius: 8px; margin-top: 10px; font-family: 'Consolas', 'Monaco', monospace;">
                    <p>-- Consultar usuarios con suscripciones activas</p>
                    <pre>SELECT u.user_id, u.username, u.first_name, s.plan, s.end_date
FROM users u
JOIN subscriptions s ON u.user_id = s.user_id
WHERE s.status = 'ACTIVE'
ORDER BY s.end_date ASC
LIMIT 20;</pre>
                </div>
                
                <div style="background-color: var(--bg-color); padding: 15px; border-radius: 8px; margin-top: 15px; font-family: 'Consolas', 'Monaco', monospace;">
                    <p>-- Contar suscripciones agrupadas por plan</p>
                    <pre>SELECT plan, COUNT(*) as total, 
SUM(CASE WHEN status = 'ACTIVE' THEN 1 ELSE 0 END) as activas
FROM subscriptions 
GROUP BY plan
ORDER BY total DESC;</pre>
                </div>
                
                <div class="alert" style="background-color: var(--status-active-bg); color: var(--status-active); padding: 15px; border-radius: 8px; margin-top: 20px;">
                    <i class="fas fa-info-circle"></i> <strong>Consejo:</strong> Usa siempre la cl√°usula LIMIT en tus consultas para evitar cargar demasiados datos.
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bot√≥n de ayuda flotante -->
    <div class="help-btn" onclick="toggleHelpModal()">
        <i class="fas fa-question"></i>
    </div>
    
    <!-- Notificaci√≥n flotante -->
    <div class="notification" id="notification">
        <i class="fas fa-info-circle"></i>
        <div id="notification-content"></div>
    </div>

    <script>
        // Funci√≥n para alternar el tema claro/oscuro
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('theme-toggle');
            const icon = themeToggle.querySelector('i');
            const text = themeToggle.querySelector('span');
            
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                icon.className = 'fas fa-moon';
                text.textContent = 'Modo Noche';
                localStorage.setItem('theme', 'light');
                document.documentElement.style.setProperty('--primary-color-rgb', '67, 97, 238');
            } else {
                body.setAttribute('data-theme', 'dark');
                icon.className = 'fas fa-sun';
                text.textContent = 'Modo D√≠a';
                localStorage.setItem('theme', 'dark');
                document.documentElement.style.setProperty('--primary-color-rgb', '76, 201, 240');
            }
            
            // Actualizar gr√°fico con el nuevo tema
            updateChartTheme();
        }
        
        // Cargar informaci√≥n del usuario de Telegram
        async function loadTelegramUserInfo(userId) {
            try {
                // Mostrar un estado de carga inicial
                document.getElementById('admin-name').textContent = 'Cargando...';
                document.getElementById('admin-id').textContent = 'ID: ' + userId;
                const avatarElement = document.getElementById('admin-avatar');
                avatarElement.innerHTML = '<span class="avatar-text"><i class="fas fa-spinner fa-spin"></i></span>';
                
                // Simulaci√≥n de carga de datos (reemplazar con llamada real a API)
                setTimeout(() => {
                    // Ejemplo de datos de usuario (simulados)
                    const userData = {
                        success: true,
                        first_name: 'Admin',
                        last_name: 'VIP',
                        username: 'admin_vip',
                        photo_url: null
                    };
                    
                    // Actualizar nombre de usuario
                    let displayName = userData.first_name || '';
                    if (userData.last_name) displayName += ' ' + userData.last_name;
                    if (!displayName && userData.username) displayName = userData.username;
                    if (!displayName) displayName = 'Admin';
                    
                    document.getElementById('admin-name').textContent = displayName;
                    document.getElementById('admin-id').textContent = 'ID: ' + userId;
                    
                    // Establecer avatar
                    setDefaultAvatar(userId, userData.first_name);
                    
                    // Mostrar notificaci√≥n de bienvenida
                    showNotification('Bienvenido al panel de administraci√≥n, ' + displayName);
                }, 800);
            } catch (error) {
                console.error('Error al cargar avatar:', error);
                setDefaultAvatar(userId);
            }
        }
        
        // Funci√≥n para establecer avatar predeterminado con iniciales
        function setDefaultAvatar(userId, firstName = null) {
            const avatarElement = document.getElementById('admin-avatar');
            
            // Limpiar contenido existente
            avatarElement.innerHTML = '<span class="avatar-text"></span>';
            
            // Obtener la inicial para mostrar
            const initialElement = avatarElement.querySelector('.avatar-text');
            if (firstName && firstName.length > 0) {
                initialElement.textContent = firstName.charAt(0).toUpperCase();
            } else {
                initialElement.textContent = 'A';
            }
            
            // Generar color basado en userId
            const colorNum = parseInt(userId.substring(0, 6), 10) % 360;
            avatarElement.style.backgroundColor = `hsl(${colorNum}, 80%, 45%)`;
            
            // Animaci√≥n de entrada
            avatarElement.style.transform = 'scale(0.8)';
            avatarElement.style.opacity = '0.5';
            setTimeout(() => {
                avatarElement.style.transform = 'scale(1)';
                avatarElement.style.opacity = '1';
            }, 100);
        }
        
        // Funci√≥n para abrir modal
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }
        
        // Funci√≥n para cerrar modal
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
                document.body.style.overflow = '';
            }
        }
        
        // Funci√≥n para verificar el estado de las suscripciones
        function checkSubscriptions() {
            openModal('subscription-check-modal');
            
            // Simulaci√≥n de carga de datos
            setTimeout(() => {
                // En este punto se har√≠a la consulta real a la base de datos
                const subscriptionsWithIssues = [
                    {
                        sub_id: 1245,
                        user_id: 78221,
                        username: 'roberto42',
                        plan: 'Premium',
                        end_date: '15/04/2025',
                        status: 'ACTIVE',
                        estado_verificado: 'INCORRECTO: Deber√≠a ser EXPIRED',
                        tipo_subscripcion: 'PAGADA'
                    },
                    {
                        sub_id: 1189,
                        user_id: 65478,
                        username: 'maria_lopez',
                        plan: 'B√°sico',
                        end_date: '28/05/2025',
                        status: 'EXPIRED',
                        estado_verificado: 'INCORRECTO: Deber√≠a ser ACTIVE',
                        tipo_subscripcion: 'WHITELIST'
                    }
                ];
                
                let tableHTML = '';
                
                if (subscriptionsWithIssues.length > 0) {
                    tableHTML = `
                        <div class="info-message error-message" style="margin-bottom: 15px;">
                            <i class="fas fa-exclamation-triangle"></i> 
                            <div>
                                <strong>Atenci√≥n:</strong> Se encontraron ${subscriptionsWithIssues.length} suscripciones con problemas.
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <button onclick="fixAllSubscriptions()" class="btn">
                                <i class="fas fa-magic"></i> Corregir todas las suscripciones
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Sub ID</th>
                                        <th>Usuario</th>
                                        <th>Plan</th>
                                        <th>Fecha fin</th>
                                        <th>Estado actual</th>
                                        <th>Verificaci√≥n</th>
                                        <th>Tipo</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>`;
                    
                    subscriptionsWithIssues.forEach(sub => {
                        const rowClass = 'style="background-color: rgba(255, 99, 71, 0.1);"';
                        const statusClass = sub.status === 'ACTIVE' ? 'badge-active' : 'badge-cancelled';
                        
                        let accionRecomendada = '';
                        if (sub.status === 'ACTIVE' && sub.estado_verificado.includes('EXPIRED')) {
                            accionRecomendada = `<button onclick="fixSubscription('expire', ${sub.sub_id})" class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.8rem;">Marcar expirada</button>`;
                        } else if (sub.status === 'EXPIRED' && sub.estado_verificado.includes('ACTIVE')) {
                            accionRecomendada = `<button onclick="fixSubscription('activate', ${sub.sub_id})" class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.8rem;">Reactivar</button>`;
                        }
                        
                        tableHTML += `
                            <tr ${rowClass}>
                                <td>${sub.sub_id}</td>
                                <td>${sub.username || 'Sin username'} <small>(${sub.user_id})</small></td>
                                <td>${sub.plan}</td>
                                <td>${sub.end_date}</td>
                                <td><span class="badge ${statusClass}">${sub.status}</span></td>
                                <td><strong>${sub.estado_verificado}</strong></td>
                                <td>${sub.tipo_subscripcion}</td>
                                <td>${accionRecomendada}</td>
                            </tr>`;
                    });
                    
                    tableHTML += `</tbody></table></div>`;
                } else {
                    tableHTML = `
                        <div class="info-message success-message">
                            <i class="fas fa-check-circle"></i> 
                            <div>
                                <strong>¬°Todo correcto!</strong> Todas las suscripciones tienen un estado correcto.
                            </div>
                        </div>
                        <p style="margin-top: 15px;">Se verificaron 624 suscripciones y no se encontraron problemas.</p>`;
                }
                
                document.getElementById('subscription-check-content').innerHTML = tableHTML;
            }, 1500);
        }
        
        // Funci√≥n para corregir una suscripci√≥n espec√≠fica
        function fixSubscription(action, subId) {
            // Mostrar carga
            document.getElementById('subscription-check-content').innerHTML = `
                <div style="display: flex; justify-content: center; padding: 40px;">
                    <div class="loading-spinner"></div>
                </div>
                <p style="text-align: center; margin-top: 20px;">Aplicando cambios...</p>
            `;
            
            // Simulaci√≥n de operaci√≥n
            setTimeout(() => {
                // En este punto se har√≠a la consulta real para actualizar la base de datos
                
                // Mostrar mensaje de √©xito
                showNotification(`Suscripci√≥n ${subId} actualizada correctamente`, 'success');
                
                // Actualizar la tabla
                checkSubscriptions();
            }, 1000);
        }
        
        // Funci√≥n para corregir todas las suscripciones de una vez
        function fixAllSubscriptions() {
            // Mostrar ventana de confirmaci√≥n
            if (!confirm("¬øEst√°s seguro de que quieres corregir todas las suscripciones con estado incorrecto?")) {
                return;
            }
            
            // Mostrar carga
            document.getElementById('subscription-check-content').innerHTML = `
                <div style="display: flex; justify-content: center; padding: 40px;">
                    <div class="loading-spinner"></div>
                </div>
                <p style="text-align: center; margin-top: 20px;">Corrigiendo todas las suscripciones...</p>
            `;
            
            // Simulaci√≥n de operaci√≥n
            setTimeout(() => {
                // En este punto se har√≠an las consultas reales para actualizar la base de datos
                
                // Mostrar mensaje de √©xito
                showNotification('Se han corregido todas las suscripciones con problemas', 'success');
                
                // Actualizar la tabla
                checkSubscriptions();
            }, 1500);
        }
        
        // Funci√≥n para enviar comandos al bot directamente desde el panel
        function sendBotCommand(command) {
            // Obtener ID de admin
            const urlParams = new URLSearchParams(window.location.search);
            const adminId = urlParams.get('admin_id') || '7212354235';
            
            // Mostrar notificaci√≥n
            showNotification(`Enviando comando ${command} al bot. Revisa tu chat con el bot para ver la respuesta.`);
            
            // Simulaci√≥n de redirecci√≥n a Telegram
            setTimeout(() => {
                // En este punto se redirigir√≠a realmente a Telegram
                showNotification(`Comando enviado correctamente. Revisa tu chat con el bot para ver la respuesta.`, 'success');
            }, 1500);
        }
        
        // Funci√≥n para mostrar notificaci√≥n
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const content = document.getElementById('notification-content');
            
            // Establecer contenido y tipo
            content.textContent = message;
            notification.className = `notification ${type}`;
            
            // Cambiar icono seg√∫n tipo
            const icon = notification.querySelector('i');
            if (type === 'success') {
                icon.className = 'fas fa-check-circle';
            } else if (type === 'error') {
                icon.className = 'fas fa-exclamation-triangle';
            } else {
                icon.className = 'fas fa-info-circle';
            }
            
            // Mostrar notificaci√≥n
            notification.classList.add('show');
            
            // Ocultar despu√©s de 4 segundos
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }
        
        // Funci√≥n para insertar plantilla SQL
        function insertSQLTemplate(template) {
            const sqlInput = document.getElementById('sql-input');
            sqlInput.value = template;
            sqlInput.focus();
            
            // Actualizar la vista previa
            updateSQLPreview(template);
        }
        
        // Funci√≥n para actualizar la vista previa de SQL
        function updateSQLPreview(query) {
            const preview = document.getElementById('sql-preview');
            
            // Formatear la consulta con colores (simplificado)
            let formattedQuery = query
                .replace(/SELECT|FROM|WHERE|ORDER BY|GROUP BY|LIMIT|JOIN|AND|OR|AS|COUNT|SUM|AVG|DISTINCT|INNER JOIN|LEFT JOIN|RIGHT JOIN|HAVING|UPDATE|SET|DELETE|INSERT INTO|VALUES/gi, 
                    match => `<span style="color: var(--primary-color); font-weight: bold;">${match}</span>`)
                .replace(/'([^']*)'/g, 
                    (match, p1) => `<span style="color: var(--secondary-color);">'${p1}'</span>`)
                .replace(/\d+/g, 
                    match => `<span style="color: var(--status-active);">${match}</span>`);
                
            preview.innerHTML = formattedQuery;
        }
        
        // Funci√≥n para mostrar/ocultar ayuda SQL
        function toggleSQLHelper() {
            openModal('sql-help-modal');
        }
        
        // Funci√≥n para ejecutar consulta SQL (simulaci√≥n)
        document.getElementById('sql-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const query = document.getElementById('sql-input').value.trim();
            
            if (!query) {
                showNotification('Por favor, ingrese una consulta SQL v√°lida', 'error');
                return;
            }
            
            // Mostrar carga
            document.getElementById('loading').style.display = 'flex';
            document.getElementById('execute-btn').disabled = true;
            
            // Ocultar mensajes anteriores
            document.getElementById('error-message').style.display = 'none';
            document.getElementById('success-message').style.display = 'none';
            document.getElementById('sql-results').style.display = 'none';
            
            // Simulaci√≥n de ejecuci√≥n de consulta
            setTimeout(() => {
                const isSelect = query.toLowerCase().trim().startsWith('select');
                
                if (isSelect) {
                    // Mostrar resultados de consulta SELECT (datos simulados)
                    simulateSelectResults(query);
                } else {
                    // Mostrar resultados de otro tipo de consulta (UPDATE, DELETE, etc.)
                    simulateNonSelectResults(query);
                }
                
                // Ocultar carga
                document.getElementById('loading').style.display = 'none';
                document.getElementById('execute-btn').disabled = false;
            }, 800);
        });
        
        // Funci√≥n para simular resultados de consulta SELECT
        function simulateSelectResults(query) {
            // Datos simulados
            let results = [];
            let columns = [];
            
            // Simular diferentes resultados seg√∫n la consulta
            if (query.toLowerCase().includes('users')) {
                columns = ['user_id', 'username', 'first_name', 'last_name', 'created_at'];
                results = [
                    {user_id: 78952, username: 'user123', first_name: 'Juan', last_name: 'P√©rez', created_at: '15/05/2025'},
                    {user_id: 78951, username: 'maria_85', first_name: 'Mar√≠a', last_name: 'L√≥pez', created_at: '14/05/2025'},
                    {user_id: 78950, username: 'andres_dev', first_name: 'Andr√©s', last_name: 'Gonz√°lez', created_at: '14/05/2025'},
                    {user_id: 78949, username: 'lucia_22', first_name: 'Luc√≠a', last_name: 'Mart√≠nez', created_at: '13/05/2025'},
                    {user_id: 78948, username: 'roberto_j', first_name: 'Roberto', last_name: 'Jim√©nez', created_at: '13/05/2025'}
                ];
            } else if (query.toLowerCase().includes('subscriptions')) {
                columns = ['sub_id', 'user_id', 'username', 'plan', 'price_usd', 'start_date', 'end_date', 'status'];
                results = [
                    {sub_id: 1354, user_id: 78952, username: 'user123', plan: 'Premium', price_usd: 49.99, start_date: '15/05/2025', end_date: '15/06/2025', status: 'ACTIVE'},
                    {sub_id: 1353, user_id: 45671, username: 'miguel_angel', plan: 'B√°sico', price_usd: 19.99, start_date: '12/05/2025', end_date: '12/06/2025', status: 'ACTIVE'},
                    {sub_id: 1352, user_id: 32147, username: 'laura84', plan: 'Premium', price_usd: 49.99, start_date: '10/04/2025', end_date: '10/05/2025', status: 'EXPIRED'},
                    {sub_id: 1351, user_id: 98745, username: 'carlos_vt', plan: 'Premium+', price_usd: 79.99, start_date: '05/05/2025', end_date: '05/06/2025', status: 'ACTIVE'},
                    {sub_id: 1350, user_id: 56234, username: 'ana_maria22', plan: 'B√°sico', price_usd: 19.99, start_date: '01/05/2025', end_date: '01/06/2025', status: 'CANCELLED'}
                ];
            } else if (query.toLowerCase().includes('count')) {
                columns = ['count'];
                results = [{count: 1248}];
            } else {
                columns = ['resultado'];
                results = [{resultado: 'No hay datos para esta consulta'}];
            }
            
            // Actualizar la tabla de resultados
            updateResultsTable(columns, results);
            
            // Mostrar el contenedor de resultados
            document.getElementById('sql-results').style.display = 'block';
            document.getElementById('result-count').textContent = results.length;
        }
        
        // Funci√≥n para simular resultados de consultas no SELECT
        function simulateNonSelectResults(query) {
            const lowerQuery = query.toLowerCase();
            
            if (lowerQuery.startsWith('update')) {
                document.getElementById('success-message').style.display = 'block';
                document.getElementById('success-content').textContent = 'Actualizaci√≥n completada. 3 filas afectadas.';
            } else if (lowerQuery.startsWith('delete')) {
                document.getElementById('success-message').style.display = 'block';
                document.getElementById('success-content').textContent = 'Eliminaci√≥n completada. 1 fila afectada.';
            } else if (lowerQuery.startsWith('insert')) {
                document.getElementById('success-message').style.display = 'block';
                document.getElementById('success-content').textContent = 'Inserci√≥n completada. 1 fila afectada.';
            } else {
                document.getElementById('error-message').style.display = 'block';
                document.getElementById('error-content').textContent = 'Consulta no reconocida o no v√°lida.';
            }
        }
        
        // Funci√≥n para actualizar la tabla de resultados
        function updateResultsTable(columns, results) {
            const headerRow = document.createElement('tr');
            
            // Crear encabezados de columnas
            columns.forEach(column => {
                const th = document.createElement('th');
                th.textContent = column;
                headerRow.appendChild(th);
            });
            
            // Actualizar encabezado de tabla
            const headerContainer = document.getElementById('results-header');
            headerContainer.innerHTML = '';
            headerContainer.appendChild(headerRow);
            
            // Crear filas de resultados
            const tbody = document.getElementById('results-body');
            tbody.innerHTML = '';
            
            results.forEach(row => {
                const tr = document.createElement('tr');
                
                columns.forEach(column => {
                    const td = document.createElement('td');
                    td.textContent = row[column] !== undefined ? row[column] : '';
                    tr.appendChild(td);
                });
                
                tbody.appendChild(tr);
            });
        }
        
        // Funci√≥n para actualizar tabla (simulaci√≥n)
        function refreshTable(tableType) {
            showNotification(`Actualizando tabla de ${tableType === 'users' ? 'usuarios' : 'suscripciones'}...`);
            
            // En este punto se har√≠a la petici√≥n real para actualizar los datos
            setTimeout(() => {
                showNotification(`Tabla de ${tableType === 'users' ? 'usuarios' : 'suscripciones'} actualizada`, 'success');
            }, 800);
        }
        
        // Inicializar gr√°fico de crecimiento
        function initGrowthChart() {
            const ctx = document.getElementById('growth-chart').getContext('2d');
            
            // Configurar datos
            const labels = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic', 'Ene', 'Feb', 'Mar', 'Abr', 'May'];
            const usuarios = [310, 350, 410, 490, 520, 590, 650, 720, 780, 850, 920, 980, 1050, 1120, 1180, 1210, 1248];
            const suscripciones = [180, 210, 250, 290, 340, 390, 410, 460, 500, 530, 580, 610, 650, 710, 750, 790, 836];
            const activas = [150, 160, 190, 220, 240, 280, 330, 370, 390, 420, 450, 490, 520, 550, 580, 600, 624];
            
            // Crear gr√°fico
            window.growthChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Usuarios',
                            data: usuarios,
                            borderColor: '#4361ee',
                            backgroundColor: 'rgba(67, 97, 238, 0.1)',
                            borderWidth: 3,
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: 'Suscripciones',
                            data: suscripciones,
                            borderColor: '#7209b7',
                            backgroundColor: 'rgba(114, 9, 183, 0.1)',
                            borderWidth: 3,
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: 'Suscripciones Activas',
                            data: activas,
                            borderColor: '#0ca678',
                            backgroundColor: 'rgba(12, 166, 120, 0.1)',
                            borderWidth: 3,
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            padding: 12,
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: {
                                size: 14
                            },
                            bodyFont: {
                                size: 13
                            },
                            displayColors: true,
                            boxPadding: 5
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(200, 200, 200, 0.1)'
                            },
                            ticks: {
                                font: {
                                    size: 12
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 12
                                }
                            }
                        }
                    }
                }
            });
            
            // Actualizar tema del gr√°fico
            updateChartTheme();
        }
        
        // Actualizar tema del gr√°fico
        function updateChartTheme() {
            if (!window.growthChart) return;
            
            const isDarkTheme = document.body.getAttribute('data-theme') === 'dark';
            const textColor = isDarkTheme ? '#e6e6e6' : '#333';
            
            window.growthChart.options.scales.y.ticks.color = textColor;
            window.growthChart.options.scales.x.ticks.color = textColor;
            window.growthChart.options.plugins.legend.labels.color = textColor;
            
            window.growthChart.update();
        }
        
        // Mostrar modal de ayuda
        function toggleHelpModal() {
            openModal('sql-help-modal');
        }
        
        // Evento para actualizar vista previa SQL al escribir
        document.getElementById('sql-input').addEventListener('input', function() {
            updateSQLPreview(this.value);
        });
        
        // Inicializar la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            // Establecer tema oscuro por defecto
            document.body.setAttribute('data-theme', 'dark');
            document.documentElement.style.setProperty('--primary-color-rgb', '76, 201, 240');
            
            // Obtener ID de admin de la URL o usar valor por defecto
            const urlParams = new URLSearchParams(window.location.search);
            const adminId = urlParams.get('admin_id') || '7212354235';
            
            // Cargar informaci√≥n del usuario
            loadTelegramUserInfo(adminId);
            
            // Inicializar gr√°fico de crecimiento
            initGrowthChart();
            
            // Establecer manejadores de eventos para tablas responsivas
            setupResponsiveTables();
            
            // Preparar b√∫squeda en tablas
            setupTableSearch();
        });
        
        // Funci√≥n para configurar tablas responsivas
        function setupResponsiveTables() {
            if (window.innerWidth <= 600) {
                const tables = document.querySelectorAll('table');
                tables.forEach(table => {
                    const headers = Array.from(table.querySelectorAll('th')).map(th => th.textContent);
                    const cells = table.querySelectorAll('td');
                    
                    cells.forEach((cell, index) => {
                        const headerIndex = index % headers.length;
                        cell.setAttribute('data-label', headers[headerIndex]);
                    });
                });
            }
        }
        
        // Funci√≥n para configurar b√∫squeda en tablas
        function setupTableSearch() {
            // Suscripciones
            document.getElementById('subscription-search').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const rows = document.querySelectorAll('#subscriptions-table tbody tr');
                
                rows.forEach(row => {
                    const text = row.textContent.toLowerCase();
                    row.style.display = text.includes(searchTerm) ? '' : 'none';
                });
            });
            
            // Usuarios
            document.getElementById('user-search').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const rows = document.querySelectorAll('#users-table tbody tr');
                
                rows.forEach(row => {
                    const text = row.textContent.toLowerCase();
                    row.style.display = text.includes(searchTerm) ? '' : 'none';
                });
            });
        }
        
        // A√±adir listener para cambio de tema
        document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
    </script>
</body>
</html>